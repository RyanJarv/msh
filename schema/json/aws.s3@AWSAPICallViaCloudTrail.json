{ "openapi" : "3.0.0", "info" : { "version" : "1.0.0", "title" : "AWSAPICallViaCloudTrail" }, "paths" : { }, "components" : { "schemas" : { "AWSEvent" : { "type" : "object", "required" : [ "detail-type", "resources", "id", "source", "time", "detail", "region", "version", "account" ], "x-amazon-events-detail-type" : "AWS API Call via CloudTrail", "x-amazon-events-source" : "aws.s3", "properties" : { "detail" : { "$ref" : "#/components/schemas/AWSAPICallViaCloudTrail" }, "detail-type" : { "type" : "string" }, "resources" : { "type" : "array", "items" : { "type" : "object" } }, "id" : { "type" : "string" }, "source" : { "type" : "string" }, "time" : { "type" : "string", "format" : "date-time" }, "region" : { "type" : "string" }, "version" : { "type" : "string" }, "account" : { "type" : "string" } } }, "AWSAPICallViaCloudTrail" : { "type" : "object", "required" : [ "eventID", "awsRegion", "eventVersion", "responseElements", "sourceIPAddress", "eventSource", "requestParameters", "resources", "userAgent", "readOnly", "userIdentity", "eventType", "additionalEventData", "requestID", "eventTime", "eventName", "recipientAccountId" ], "properties" : { "requestParameters" : { "$ref" : "#/components/schemas/RequestParameters" }, "tlsDetails" : { "$ref" : "#/components/schemas/TlsDetails" }, "userIdentity" : { "$ref" : "#/components/schemas/UserIdentity" }, "additionalEventData" : { "$ref" : "#/components/schemas/AdditionalEventData" }, "eventID" : { "type" : "string" }, "awsRegion" : { "type" : "string" }, "eventCategory" : { "type" : "string" }, "responseElements" : { "type" : "object", "nullable" : true }, "sourceIPAddress": { "type": "string" }, "eventName" : { "type" : "string" }, "eventSource" : { "type" : "string" }, "eventTime" : { "type" : "string", "format" : "date-time" }, "eventVersion" : { "type" : "string" }, "managementEvent" : { "type" : "boolean" }, "errorMessage" : { "type" : "string" }, "resources" : { "type" : "array", "items" : { "$ref" : "#/components/schemas/AWSAPICallViaCloudTrailItem" } }, "errorCode" : { "type" : "string" }, "userAgent" : { "type" : "string" }, "readOnly" : { "type" : "boolean" }, "eventType" : { "type" : "string" }, "vpcEndpointId" : { "type" : "string" }, "requestID" : { "type" : "string" }, "recipientAccountId" : { "type" : "string" } } }, "RequestParameters" : { "type" : "object", "required" : [ "bucketName", "key", "Host" ], "properties" : { "bucketName" : { "type" : "string" }, "legal-hold" : { "type" : "string" }, "key" : { "type" : "string" }, "retention" : { "type" : "string" }, "Host" : { "type" : "string" } } }, "UserIdentity" : { "type" : "object", "required" : [ "accessKeyId", "sessionContext", "accountId", "principalId", "arn", "type" ], "properties" : { "sessionContext" : { "$ref" : "#/components/schemas/SessionContext" }, "accessKeyId" : { "type" : "string" }, "accountId" : { "type" : "string" }, "principalId" : { "type" : "string" }, "type" : { "type" : "string" }, "arn" : { "type" : "string" } } }, "AdditionalEventData" : { "type" : "object", "required" : [ "SignatureVersion", "CipherSuite", "bytesTransferredIn", "AuthenticationMethod", "x-amz-id-2", "bytesTransferredOut" ], "properties" : { "objectRetentionInfo" : { "$ref" : "#/components/schemas/ObjectRetentionInfo" }, "x-amz-id-2" : { "type" : "string" }, "AuthenticationMethod" : { "type" : "string" }, "CipherSuite" : { "type" : "string" }, "SignatureVersion" : { "type" : "string" }, "bytesTransferredIn" : { "type" : "number" }, "bytesTransferredOut" : { "type" : "number" } } }, "SessionContext" : { "type" : "object", "required" : [ "attributes", "webIdFederationData", "sessionIssuer" ], "properties" : { "attributes" : { "$ref" : "#/components/schemas/Attributes" }, "sessionIssuer" : { "$ref" : "#/components/schemas/SessionIssuer" }, "webIdFederationData" : { "$ref" : "#/components/schemas/WebIdFederationData" } } }, "ObjectRetentionInfo" : { "type" : "object", "properties" : { "legalHoldInfo" : { "$ref" : "#/components/schemas/LegalHoldInfo" }, "retentionInfo" : { "$ref" : "#/components/schemas/RetentionInfo" } } }, "Attributes" : { "type" : "object", "required" : [ "mfaAuthenticated", "creationDate" ], "properties" : { "mfaAuthenticated" : { "type" : "string" }, "creationDate" : { "type" : "string", "format" :  "date-time" } } }, "LegalHoldInfo" : { "type" : "object", "properties" : { "lastModifiedTime" : { "type" : "integer", "format" : "int64" }, "isUnderLegalHold" : { "type" : "boolean" } } }, "RetentionInfo" : { "type" : "object", "properties" : { "lastModifiedTime" : { "type" : "integer", "format" : "int64" }, "retainUntilTime" : { "type" : "integer", "format" : "int64" }, "retainUntilMode" : { "type" : "string" } } }, "TlsDetails" : { "type" : "object", "required" : [ "tlsVersion", "cipherSuite", "clientProvidedHostHeader" ], "properties" : { "cipherSuite" : { "type" : "string" }, "clientProvidedHostHeader" : { "type" : "string" }, "tlsVersion" : { "type" : "string" } } }, "AWSAPICallViaCloudTrailItem" : { "type" : "object", "required" : [ "accountId", "type", "ARN" ], "properties" : { "ARN" : { "type" : "string" }, "accountId" : { "type" : "string" }, "type" : { "type" : "string" } } }, "SessionIssuer" : { "type" : "object", "required" : [ "accountId", "principalId", "arn", "type", "userName" ], "properties" : { "accountId" : { "type" : "string" }, "arn" : { "type" : "string" }, "principalId" : { "type" : "string" }, "type" : { "type" : "string" }, "userName" : { "type" : "string" } } }, "WebIdFederationData" : { "type" : "object" } } } }
